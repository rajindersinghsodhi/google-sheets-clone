<div class="spreadsheet-container relative border border-gray-300 rounded-md overflow-auto w-full h-[79vh]">
    <!-- Header Row (Sticky) -->
    <div class="flex sticky top-0 z-10">
        <div class="min-w-10 max-w-10 h-8 flex items-center justify-center bg-gray-200 border-r border-gray-300"></div>
        <div *ngFor="let col of columns" class="min-w-24 max-w-24 h-8 flex items-center justify-center border-r border-gray-300 text-xs font-bold bg-gray-100 border-b border-gray-300">
            {{ col }}
        </div>
    </div>

    <!-- Rows -->
    <div class="spreadsheet-body">
        <div *ngFor="let row of rows; let rowIndex = index" class="flex">
            <!-- Row Number -->
            <div class="stick   y left-0 min-w-10 max-w-10 h-8 flex items-center justify-center text-xs font-bold bg-gray-100">
                {{ rowIndex + 1 }}
            </div>

            <!-- Spreadsheet Cells -->
            <div 
                *ngFor="let cell of row; let colIndex = index"
                contenteditable="true"
                class="cell min-w-24 max-w-24 h-8 flex items-center focus:outline-none border border-gray-100"
                (keydown)="handleKeydown($event, rowIndex, colIndex)"
                (click)="handleClick(rowIndex, colIndex)"
                [ngStyle]="{ 'border': (selectedCellIndex === rowIndex * totalCols + colIndex) ? '2px solid blue' : '' }"
            >
            </div>
        </div>
    </div>
</div>
