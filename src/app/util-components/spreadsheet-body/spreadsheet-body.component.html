<div class="spreadsheet-container relative border border-gray-300 rounded-md overflow-auto w-full h-[70vh]">
    <!-- Header Row (Sticky) -->
    <div class="flex sticky top-0 bg-gray-100 border-b border-gray-300 z-10">
        <div class="w-12 h-8 flex items-center justify-center bg-gray-200 border-r border-gray-300"></div>
        <div *ngFor="let col of columns" class="w-24 h-8 flex items-center justify-center border-r border-gray-300 text-xs font-bold">
            {{ col }}
        </div>
    </div>

    <!-- Rows -->
    <div class="spreadsheet-body">
        <div *ngFor="let row of rows; let rowIndex = index" class="flex ">
            <!-- Row Number -->
            <div class="w-12 h-8 flex items-center justify-center bg-gray-100 text-xs font-bold">
                {{ rowIndex + 1 }}
            </div>

            <!-- Spreadsheet Cells -->
            <div 
                *ngFor="let cell of row; let colIndex = index"
                contenteditable="true"
                class="cell w-24 h-8 px-2 flex items-center focus:outline-none border border-gray-100"
                (keydown)="handleKeydown($event, rowIndex, colIndex)"
                [ngStyle]="{ 'border': (selectedCellIndex === rowIndex * totalCols + colIndex) ? '2px solid blue' : '' }"
            >
            {{rowIndex * totalCols + colIndex}}
            </div>
        </div>
    </div>
</div>
